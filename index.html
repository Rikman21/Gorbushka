<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; text-align: center; }
        .btn { 
            display: block; width: 100%; padding: 20px; margin-top: 20px; 
            font-size: 18px; font-weight: bold; background: #007aff; color: white; 
            border: none; border-radius: 10px; cursor: pointer;
        }
        .info { background: #eee; padding: 10px; border-radius: 10px; margin-top: 10px; word-break: break-all; }
    </style>
</head>
<body>
    <h1>–¢–ï–°–¢ –°–í–Ø–ó–ò</h1>
    <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï –∑–∞–∫—Ä–æ–µ—Ç—Å—è, –Ω–æ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã —É–ª–µ—Ç–µ—Ç—å –≤ –±–æ—Ç–∞.</p>
    
    <div class="info" id="debug-info">–í–∞—à ID: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</div>

    <button class="btn" onclick="sendTestSignal()">üöÄ –û–¢–ü–†–ê–í–ò–¢–¨ –°–ò–ì–ù–ê–õ</button>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // --- –í–ê–ñ–ù–û: –í–ü–ò–®–ò–¢–ï –°–Æ–î–ê –°–í–û–ô ID ---
        const myIdForTest = 464896073; 

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º ID –Ω–∞ —ç–∫—Ä–∞–Ω–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        const userId = tg.initDataUnsafe.user?.id || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";
        document.getElementById('debug-info').innerText = "–í–∞—à ID –≤ –¢–µ–ª–µ–≥—Ä–∞–º: " + userId;

        function sendTestSignal() {
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
            // REQ_BUY | ID_–ü—Ä–æ–¥–∞–≤—Ü–∞ | –ò–º—è_–ü—Ä–æ–¥–∞–≤—Ü–∞ | –¢–æ–≤–∞—Ä | –¶–µ–Ω–∞
            const data = `REQ_BUY|${myIdForTest}|Test_Seller|iPhone 16 Pro TEST|100`;

            // 1. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
            alert("–°–µ–π—á–∞—Å –æ—Ç–ø—Ä–∞–≤–ª—é –¥–∞–Ω–Ω—ã–µ:\n" + data);

            // 2. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –±–æ—Ç–∞
            tg.sendData(data);

            // 3. –ù–ï –ó–ê–ö–†–´–í–ê–ï–ú –ü–†–ò–õ–û–ñ–ï–ù–ò–ï (—á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ–ª–∏ —É–π—Ç–∏)
            // tg.close(); <--- –Ø –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ!
            
            alert("–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã! –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —á–µ—Ä–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.");
        }
    </script>
</body>
</html>
